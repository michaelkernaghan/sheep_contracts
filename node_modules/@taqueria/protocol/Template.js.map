{"version":3,"sources":["Template.ts"],"sourcesContent":["import createType from '@taqueria/protocol/Base';\nimport * as Command from '@taqueria/protocol/Command';\nimport * as Option from '@taqueria/protocol/Option';\nimport * as PluginJsonResponse from '@taqueria/protocol/PluginJsonResponse';\nimport * as PluginResponseEncoding from '@taqueria/protocol/PluginResponseEncoding';\nimport * as PositionalArg from '@taqueria/protocol/PositionalArg';\nimport * as RequestArgs from '@taqueria/protocol/RequestArgs';\nimport * as Verb from '@taqueria/protocol/Verb';\nimport { z } from 'zod';\n\nconst handlerSchema = z.union([\n\tz.string().min(1),\n\tz.function().args(RequestArgs.schemas.schema).returns(z.union([\n\t\tz.void(),\n\t\tPluginJsonResponse.schemas.schema,\n\t\tPluginJsonResponse.schemas.internalSchema,\n\t\tz.promise(\n\t\t\tz.union([\n\t\t\t\tz.promise(z.void()),\n\t\t\t\tz.void(),\n\t\t\t\tPluginJsonResponse.schemas.schema,\n\t\t\t\tPluginJsonResponse.schemas.internalSchema,\n\t\t\t]),\n\t\t),\n\t])),\n]);\n\nexport const rawSchema = z.object({\n\ttemplate: Verb.rawSchema,\n\tcommand: Command.rawSchema,\n\tdescription: z.string().min(4),\n\thidden: z.preprocess(\n\t\tval => val ?? false,\n\t\tz.boolean(),\n\t).optional(),\n\toptions: z.preprocess(\n\t\tval => val ?? [],\n\t\tz.array(Option.rawSchema),\n\t).optional(),\n\tpositionals: z.preprocess(\n\t\tval => val ?? [],\n\t\tz.array(PositionalArg.rawSchema),\n\t).optional(),\n\thandler: handlerSchema.describe('Template Handler'),\n\tencoding: PluginResponseEncoding.schemas.schema.optional(),\n});\n\nexport const internalSchema = rawSchema.extend({\n\ttemplate: Verb.schemas.schema,\n\tcommand: Command.schemas.schema,\n\toptions: z.preprocess(\n\t\tval => val ?? [],\n\t\tz.array(Option.schemas.schema),\n\t).optional(),\n\tpositionals: z.preprocess(\n\t\tval => val ?? [],\n\t\tz.array(PositionalArg.schemas.schema),\n\t).optional(),\n});\n\ntype RawInput = z.infer<typeof rawSchema>;\ntype Input = z.infer<typeof internalSchema>;\n\nexport const { schemas: generatedSchemas, factory } = createType<RawInput, Input>({\n\trawSchema,\n\tinternalSchema,\n\tparseErrMsg: (value: unknown) => `The following template is invalid: ${value}`,\n\tunknownErrMsg: 'Something went wrong trying to parse the template',\n});\n\nexport type Template = z.infer<typeof generatedSchemas.schema>;\nexport type t = Template;\nexport const { create, make, of } = factory;\nexport const schemas = {\n\t...generatedSchemas,\n\tschema: generatedSchemas.schema.transform(val => val as unknown as Template),\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAAA;AAAA,EAAA,eAAAC;AAAA;AAAA;AAAA,kBAAuB;AACvB,cAAyB;AACzB,aAAwB;AACxB,yBAAoC;AACpC,6BAAwC;AACxC,oBAA+B;AAC/B,kBAA6B;AAC7B,WAAsB;AACtB,iBAAkB;AAElB,IAAM,gBAAgB,aAAE,MAAM;AAAA,EAC7B,aAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAChB,aAAE,SAAS,EAAE,KAAiB,oBAAQ,MAAM,EAAE,QAAQ,aAAE,MAAM;AAAA,IAC7D,aAAE,KAAK;AAAA,IACY,2BAAQ;AAAA,IACR,2BAAQ;AAAA,IAC3B,aAAE;AAAA,MACD,aAAE,MAAM;AAAA,QACP,aAAE,QAAQ,aAAE,KAAK,CAAC;AAAA,QAClB,aAAE,KAAK;AAAA,QACY,2BAAQ;AAAA,QACR,2BAAQ;AAAA,MAC5B,CAAC;AAAA,IACF;AAAA,EACD,CAAC,CAAC;AACH,CAAC;AAEM,IAAMD,aAAY,aAAE,OAAO;AAAA,EACjC,UAAe;AAAA,EACf,SAAiB;AAAA,EACjB,aAAa,aAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAC7B,QAAQ,aAAE;AAAA,IACT,SAAO,OAAO;AAAA,IACd,aAAE,QAAQ;AAAA,EACX,EAAE,SAAS;AAAA,EACX,SAAS,aAAE;AAAA,IACV,SAAO,OAAO,CAAC;AAAA,IACf,aAAE,MAAa,gBAAS;AAAA,EACzB,EAAE,SAAS;AAAA,EACX,aAAa,aAAE;AAAA,IACd,SAAO,OAAO,CAAC;AAAA,IACf,aAAE,MAAoB,uBAAS;AAAA,EAChC,EAAE,SAAS;AAAA,EACX,SAAS,cAAc,SAAS,kBAAkB;AAAA,EAClD,UAAiC,+BAAQ,OAAO,SAAS;AAC1D,CAAC;AAEM,IAAM,iBAAiBA,WAAU,OAAO;AAAA,EAC9C,UAAe,aAAQ;AAAA,EACvB,SAAiB,gBAAQ;AAAA,EACzB,SAAS,aAAE;AAAA,IACV,SAAO,OAAO,CAAC;AAAA,IACf,aAAE,MAAa,eAAQ,MAAM;AAAA,EAC9B,EAAE,SAAS;AAAA,EACX,aAAa,aAAE;AAAA,IACd,SAAO,OAAO,CAAC;AAAA,IACf,aAAE,MAAoB,sBAAQ,MAAM;AAAA,EACrC,EAAE,SAAS;AACZ,CAAC;AAKM,IAAM,EAAE,SAAS,kBAAkB,QAAQ,QAAI,YAAAE,SAA4B;AAAA,EACjF,WAAAF;AAAA,EACA;AAAA,EACA,aAAa,CAAC,UAAmB,sCAAsC;AAAA,EACvE,eAAe;AAChB,CAAC;AAIM,IAAM,EAAE,QAAQ,MAAM,GAAG,IAAI;AAC7B,IAAMC,WAAU;AAAA,EACtB,GAAG;AAAA,EACH,QAAQ,iBAAiB,OAAO,UAAU,SAAO,GAA0B;AAC5E;","names":["rawSchema","schemas","createType"]}