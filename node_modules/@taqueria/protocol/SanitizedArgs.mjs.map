{"version":3,"sources":["SanitizedArgs.ts"],"sourcesContent":["import createType from '@taqueria/protocol/Base';\nimport * as PluginResponseEncoding from '@taqueria/protocol/PluginResponseEncoding';\nimport * as SanitizedAbsPath from '@taqueria/protocol/SanitizedAbsPath';\nimport * as Url from '@taqueria/protocol/Url';\nimport { z } from 'zod';\n\nexport const rawSchema = z.object({\n\t_: z.array(z.union([z.string().min(1), z.number()])),\n\tprojectDir: SanitizedAbsPath.schemas.schema,\n\tmaxConcurrency: z.preprocess(\n\t\tval => typeof val === 'string' ? parseInt(val) : Number(val),\n\t\tz.number().int().min(1).default(10),\n\t),\n\tdebug: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().default(false),\n\t),\n\tdisableState: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().default(false),\n\t),\n\tlogPluginRequests: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().default(false),\n\t),\n\tfromVsCode: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().default(false),\n\t),\n\tversion: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().optional(),\n\t),\n\tbuild: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().optional(),\n\t),\n\thelp: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().optional(),\n\t),\n\tyes: z.preprocess(\n\t\tval => Boolean(val),\n\t\tz.boolean().optional(),\n\t),\n\tplugin: z.string().min(1).optional(),\n\tenv: z.union([z.literal('production'), z.literal('testing'), z.literal('development'), z.string().nonempty()])\n\t\t.default('development'),\n\tquickstart: z.string().min(1).optional(),\n\tsetBuild: z.preprocess(\n\t\tval => String(val),\n\t\tz.string().min(3),\n\t),\n\tsetVersion: z.string().min(3),\n\tpluginName: z.string().min(1).optional(),\n}, { description: 'Sanitizied Args' }).passthrough();\n\nexport const scaffoldRawSchema = rawSchema.extend({\n\tscaffoldProjectDir: z.string().min(1).transform((val: unknown) => val as SanitizedAbsPath.t),\n\tscaffoldUrl: z.string().min(1).url().transform((val: unknown) => val as Url.t),\n});\n\nexport const provisionRawSchema = rawSchema\n\t.extend({\n\t\toperation: z\n\t\t\t.string()\n\t\t\t.min(1)\n\t\t\t.describe('Operation name'),\n\t\tname: z\n\t\t\t.string()\n\t\t\t.min(1)\n\t\t\t.regex(\n\t\t\t\t/^[a-z0-9]+[a-z0-9-_]$/,\n\t\t\t\t'Provisioner name must consist of one or more letters/numbers and may not start with an underscore or dash.',\n\t\t\t)\n\t\t\t.describe('Provisioner name')\n\t\t\t.optional(),\n\t})\n\t.passthrough();\n\nexport const templateRawSchema = rawSchema.extend({\n\ttemplate: z.string().min(1),\n}).passthrough();\n\nexport const managePluginRawSchema = rawSchema.omit({ pluginName: true }).extend({\n\tpluginName: z.string().min(1),\n});\n\nexport const versionRawSchema = rawSchema.extend({\n\tversion: z.boolean().default(true),\n});\n\nexport const addContractsRawSchema = z.preprocess(\n\tval => {\n\t\tconst obj: {\n\t\t\tcontractName?: string;\n\t\t\tsourceFile?: string;\n\t\t} = typeof val === 'object' ? Object(val) : ({ contractName: '', sourceFile: '' });\n\t\treturn !obj.contractName && obj.sourceFile\n\t\t\t? { ...obj, contractName: obj['sourceFile'] }\n\t\t\t: obj;\n\t},\n\trawSchema.extend({\n\t\tsourceFile: z.string().min(1),\n\t\tcontractName: z.string().min(1),\n\t}),\n);\n\nexport const removeContractsRawSchema = rawSchema.extend({\n\tcontractName: z.string().min(1),\n});\n\ntype RawInput = z.infer<typeof rawSchema>;\ntype RawScaffoldInput = z.infer<typeof scaffoldRawSchema>;\ntype RawProvisionInput = z.infer<typeof provisionRawSchema>;\ntype RawManagePluginInput = z.infer<typeof managePluginRawSchema>;\ntype RawVersionInput = z.infer<typeof versionRawSchema>;\ntype RawTemplateInput = z.infer<typeof templateRawSchema>;\ntype RawAddContractsInput = z.infer<typeof addContractsRawSchema>;\ntype RawRemoveContractsInput = z.infer<typeof removeContractsRawSchema>;\n\nexport const { schemas: generatedSchemas, factory } = createType<RawInput, RawInput>({\n\trawSchema,\n\tparseErrMsg: 'The arguments provided are invalid',\n\tunknownErrMsg: 'Something went wrong parsing the command-line arguments',\n});\n\nexport const { create, of, make } = factory;\n\nexport type SanitizedArgs = z.infer<typeof generatedSchemas.schema>;\nexport type t = SanitizedArgs;\n\nexport const schemas = {\n\t...generatedSchemas,\n\tschema: generatedSchemas.schema.transform(val => val as SanitizedArgs),\n};\n\nexport const scaffoldTaskArgs = createType<RawScaffoldInput, RawScaffoldInput>({\n\trawSchema: scaffoldRawSchema,\n\tparseErrMsg: 'The arguments provided are invalid for the scaffold task',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for the scaffold task',\n});\n\nexport const provisionTaskArgs = createType<RawProvisionInput, RawProvisionInput>({\n\trawSchema: provisionRawSchema,\n\tparseErrMsg: 'The arguments provided are invalid for the provision task',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for the provision task',\n});\n\nexport const installTaskArgs = createType<RawManagePluginInput, RawManagePluginInput>({\n\trawSchema: managePluginRawSchema,\n\tparseErrMsg: 'The arguments provided are invalid for the install task',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for the install task',\n});\n\nexport const uninstallTaskArgs = createType<RawManagePluginInput, RawManagePluginInput>({\n\trawSchema: managePluginRawSchema,\n\tparseErrMsg: 'The arguments provided are invalid for the uninstall task',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for the uninstall task',\n});\n\nexport const createTaskArgs = createType<RawTemplateInput, RawTemplateInput>({\n\trawSchema: templateRawSchema,\n\tparseErrMsg: 'The arguments provided are invalid for the create task',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for the create task',\n});\n\nexport const addContractArgs = createType<RawAddContractsInput, RawAddContractsInput>({\n\trawSchema: addContractsRawSchema,\n\tparseErrMsg: 'Please specify the source file to register.',\n\tunknownErrMsg: 'Something went wrong parsing the arguments for registering a contract.',\n});\n\nexport const removeContractsArgs = createType<RawRemoveContractsInput, RawRemoveContractsInput>({\n\trawSchema: removeContractsRawSchema,\n\tparseErrMsg: 'Please specify the contract name to unregister.',\n\tunknownErrMsg: 'Something went wrong parsing the arguments to unregister a contract.',\n});\n\nexport type ScaffoldTaskArgs = z.infer<typeof scaffoldTaskArgs.schemas.schema>;\nexport type ProvisionTaskArgs = z.infer<typeof provisionTaskArgs.schemas.schema>;\nexport type InstallTaskArgs = z.infer<typeof installTaskArgs.schemas.schema>;\nexport type UninstallTaskArgs = z.infer<typeof uninstallTaskArgs.schemas.schema>;\nexport type CreateTaskArgs = z.infer<typeof createTaskArgs.schemas.schema>;\nexport type AddContractArgs = z.infer<typeof addContractArgs.schemas.schema>;\nexport type RemoveContractArgs = z.infer<typeof removeContractsArgs.schemas.schema>;\n\nexport const createScaffoldTaskArgs = scaffoldTaskArgs.factory.from;\nexport const makeScaffoldTaskArgs = scaffoldTaskArgs.factory.make;\nexport const ofScaffoldTaskArgs = scaffoldTaskArgs.factory.of;\n\nexport const createProvisionTaskArgs = provisionTaskArgs.factory.create;\nexport const makeProvisionTaskArgs = provisionTaskArgs.factory.make;\nexport const ofProvisionTaskArgs = provisionTaskArgs.factory.of;\n\nexport const createInstallTaskArgs = installTaskArgs.factory.create;\nexport const makeInstallTaskArgs = installTaskArgs.factory.make;\nexport const ofInstallTaskArgs = installTaskArgs.factory.of;\n\nexport const createUninstallTaskArgs = uninstallTaskArgs.factory.create;\nexport const makeUninstallTaskArgs = uninstallTaskArgs.factory.make;\nexport const ofUninstallTaskArgs = uninstallTaskArgs.factory.of;\n\nexport const createCreateTaskArgs = createTaskArgs.factory.create;\nexport const makeCreateTaskArgs = createTaskArgs.factory.make;\nexport const ofCreateTaskArgs = createTaskArgs.factory.of;\nexport const createAddContractArgs = addContractArgs.factory.create;\nexport const makeAddContractArgs = addContractArgs.factory.make;\nexport const ofAddContractArgs = addContractArgs.factory.of;\n\nexport const createRemoveContractsArgs = removeContractsArgs.factory.create;\nexport const makeRemoveContractsArgs = removeContractsArgs.factory.make;\nexport const ofRemoveContractsArgs = removeContractsArgs.factory.of;\n"],"mappings":"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","names":["schemas"]}